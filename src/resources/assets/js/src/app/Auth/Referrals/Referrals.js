"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_http=require("rufUtils/http"),_http2=_interopRequireDefault(_http),_image=require("rufUtils/image"),_image2=_interopRequireDefault(_image),_reduxConnect=require("rufUtils/redux-connect"),_reduxConnect2=_interopRequireDefault(_reduxConnect),_moment=require("moment"),_moment2=_interopRequireDefault(_moment),_Loading=require("rufUtils/Loading"),_Loading2=_interopRequireDefault(_Loading),Referrals=function(e){function t(e,r){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.store=r.store,a.state={loading:!1},a}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){this.getData(1)}},{key:"getData",value:function(e){var t=this;this.setState({loading:!0}),_http2.default.get("/data/referals?page="+e,null,{returnAllData:!0}).then(function(e){t.state.loading=!1,t.store.dispatch({data:e,type:"saveReferralData"})})}},{key:"render",value:function(){return this.props.referrals.data?_react2.default.createElement("div",{className:"container"},_react2.default.createElement("h3",null,"Referrals"),_react2.default.createElement("div",{className:"text-center pt-2 pb-2"},"You have ",this.props.referrals.total," referrals."),_react2.default.createElement("table",{className:"table table-hover table-striped w-100 mx-auto"},_react2.default.createElement("tbody",null,this.props.referrals.data.map(function(e){return _react2.default.createElement("tr",{key:e.id},_react2.default.createElement("td",null,_moment2.default.utc(e.date).local().format("lll")),_react2.default.createElement("td",null,_react2.default.createElement("img",{src:(0,_image2.default)(e.image,50),style:{maxWidth:"30px"}})),_react2.default.createElement("td",null,e.first_name))}))),this.props.referrals.next_page_url&&_react2.default.createElement("div",{className:"text-center"},_react2.default.createElement("button",{className:"btn btn-primary",style:{minWidth:"130px"},disabled:this.state.loading,onClick:this.getData.bind(this,this.props.referrals.current_page+1)},this.state.loading?_react2.default.createElement(_Loading2.default,null):"Show more"))):_react2.default.createElement(_Loading2.default,null)}}]),t}(_react.Component);module.exports=(0,_reduxConnect2.default)(Referrals,{referrals:"referrals"});