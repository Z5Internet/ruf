"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_http=require("rufUtils/http"),_http2=_interopRequireDefault(_http);require("font-awesome/css/font-awesome.css");var _RenderNotifications=require("./RenderNotifications"),_RenderNotifications2=_interopRequireDefault(_RenderNotifications),_reduxConnect=require("rufUtils/redux-connect"),_reduxConnect2=_interopRequireDefault(_reduxConnect),_reactstrap=require("reactstrap"),Notifications=function(t){function e(t){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.state={loaded:!1,loading:!1,notifications:{}},i.getData=i.getData.bind(i),i}return _inherits(e,t),_createClass(e,[{key:"componentWillUnmount",value:function(){this.unmounted=!0}},{key:"componentDidMount",value:function(){var t=Object.assign({},this.props.uiNotifications);t.notifications?this.setState({loaded:!0,notifications:t}):this.getData()}},{key:"getData",value:function(){var t=this;if(!this.state.loading){this.setState({loading:!0});var e=this.state.notifications.endCursor;if(!(e<1))return _http2.default.get("/data/uiNotifications?endCursor="+(void 0!==e?e:"")).then(function(e){if(!t.unmounted){t.context.store.dispatch({type:"addUsers",data:e});var i=e.uiNotifications,n=t.state.notifications;n.notifications?(n.endCursor=i.endCursor,n.notifications=n.notifications.concat(i.notifications)):n=i,t.setState({loaded:!0,loading:!1,notifications:n})}})}}},{key:"render",value:function(){return this.state.loaded?_react2.default.createElement("div",{className:"container"},_react2.default.createElement("div",{className:"row"},_react2.default.createElement("div",{className:"col-12 notifications"},_react2.default.createElement("h4",null,"Notifications"),_react2.default.createElement(_reactstrap.ListGroup,null,_react2.default.createElement(_RenderNotifications2.default,{notifications:this.state.notifications.notifications,tag:"list"}),_react2.default.createElement(_reactstrap.ListGroupItem,{className:"text-center"},this.state.notifications.endCursor>0?_react2.default.createElement("button",{className:"btn btn-primary btn-sm",disabled:this.state.loading,onClick:this.getData},"More..."):_react2.default.createElement("div",{className:"text-center text-muted small"},"No more notifications to see")))))):_react2.default.createElement("div",{className:"text-center"},_react2.default.createElement("div",{className:"fa fa-3x fa-cog fa-spin"}))}}]),e}(_react.Component);module.exports=(0,_reduxConnect2.default)(Notifications,{uiNotifications:"uiNotifications"});